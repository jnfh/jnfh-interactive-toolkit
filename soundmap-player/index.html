<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JnfH Soundmap Builder</title>
  
  <link rel="stylesheet" href="css/player.css">
</head>
<body>
  <div id="app">
    <div id="controls">
      <div class="control-group">
        <h2 id="project-title">Soundmap Builder</h2>
        <button id="mode-btn" class="btn-primary">Edit Mode</button>
        <button id="play-btn" class="btn-secondary">Preview</button>
      </div>
      
      <div class="control-group">
        <label>Master Volume</label>
        <input type="range" id="master-volume" min="0" max="100" value="80">
        <span id="volume-value">80%</span>
      </div>
      
      <div class="control-group">
        <label>Fade Distance</label>
        <input type="range" id="fade-radius" min="50" max="500" value="100" step="10">
        <span id="fade-radius-value">100px</span>
      </div>
      
      <div class="control-group">
        <label>Fade Speed</label>
        <input type="range" id="fade-speed" min="0.05" max="1" value="0.3" step="0.05">
        <span id="fade-speed-value">0.3s</span>
      </div>
      
      <div class="control-group">
        <label>Reverb Amount</label>
        <input type="range" id="reverb-amount" min="0" max="100" value="100">
        <span id="reverb-value">100%</span>
      </div>
      
      <div id="edit-panel" class="control-group">
        <h3>Drawing Tools</h3>
        <div style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
          <button id="tool-path" class="btn-secondary" style="flex: 1; min-width: 80px;">Path</button>
          <button id="tool-rectangle" class="btn-secondary" style="flex: 1; min-width: 80px;">Rectangle</button>
          <button id="tool-circle" class="btn-secondary" style="flex: 1; min-width: 80px;">Circle</button>
          <button id="tool-polygon" class="btn-secondary" style="flex: 1; min-width: 80px;">Polygon</button>
        </div>
        
        <h3>Assign Audio to Shape</h3>
        <input type="text" id="source-name" placeholder="Shape name">
        <input type="file" id="audio-file" accept="audio/*">
        <input type="number" id="fade-distance" placeholder="Fade distance (px)" value="100">
        <button id="assign-audio" class="btn-secondary">Assign Audio</button>
        <p style="font-size: 11px; color: #666; margin-top: 8px;">
          Select a drawing tool, draw a shape, then assign audio to it.
        </p>
      </div>
      
      <div id="sources-list" class="control-group">
        <h3>Audio Sources (<span id="source-count">0</span>)</h3>
        <div id="source-items"></div>
        <h3 style="margin-top: 20px;">Audio Paths (<span id="path-count">0</span>)</h3>
        <div id="path-items"></div>
      </div>
      
      <div id="status" class="control-group status-hidden">
        <div class="status-item">
          <span class="label">Mode:</span>
          <span id="current-mode">Edit</span>
        </div>
        <div class="status-item">
          <span class="label">Distance:</span>
          <span id="distance-display">-</span>
        </div>
      </div>
      
      <div class="control-group">
        <button id="export-config" class="btn-secondary">Export Config</button>
      </div>
      
      <div class="control-group">
        <h3>Instructions</h3>
        <p style="font-size: 12px; color: #999; line-height: 1.6;">
          <strong>Edit Mode:</strong><br>
          � Upload audio file and enter name<br>
          � Click "Add to Map"<br>
          � Click map to place source<br>
          � Drag sources to reposition<br>
          � Right-click to delete<br>
          <br>
          <strong>Preview Mode:</strong><br>
          � Move mouse to hear spatial audio<br>
          � HRTF binaural positioning<br>
          � Distance-based fading<br>
          � Reverb send/return system<br>
          <br>
          <strong>Export:</strong><br>
          � Saves config as JSON<br>
          � Upload audio files to R2 manually<br>
          � Config references R2 URLs
        </p>
      </div>
    </div>
    
    <div id="canvas-container" style="position: relative; width: 100%; height: 100vh; background: #0a0a0a;">
      <canvas id="canvas"></canvas>
    </div>
  </div>
  
  <script src="js/soundmap-builder.js"></script>
  
  <script>
    let soundmapBuilder;
    
    const defaultConfig = {
      title: "New Soundmap",
      canvasWidth: 1920,
      canvasHeight: 1080,
      audioZones: []
    };
    
    soundmapBuilder = new SoundmapBuilder('canvas', defaultConfig);
    soundmapBuilder.init();
  </script>
</body>
</html>
