<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JnfH Soundmap Builder</title>
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="css/player.css">
</head>
<body>
  <div id="app">
    <div id="controls">
      <div class="control-group">
        <h2 id="project-title">Soundmap Builder</h2>
        <button id="mode-btn" class="btn-primary">Edit Mode</button>
        <button id="play-btn" class="btn-secondary">Preview</button>
      </div>
      
      <div class="control-group">
        <label>Master Volume</label>
        <input type="range" id="master-volume" min="0" max="100" value="80">
        <span id="volume-value">80%</span>
      </div>
      
      <div id="edit-panel" class="control-group">
        <h3>Add Audio Source</h3>
        <input type="text" id="source-name" placeholder="Source name">
        <input type="file" id="audio-file" accept="audio/*">
        <input type="number" id="max-distance" placeholder="Max distance (m)" value="500">
        <button id="add-source" class="btn-secondary">Add to Map</button>
        <p style="font-size: 11px; color: #666; margin-top: 8px;">
          Click "Add to Map" then click on the map to place the source
        </p>
      </div>
      
      <div id="sources-list" class="control-group">
        <h3>Audio Sources</h3>
        <div id="source-items"></div>
      </div>
      
      <div id="status" class="control-group status-hidden">
        <div class="status-item">
          <span class="label">Mode:</span>
          <span id="current-mode">Edit</span>
        </div>
        <div class="status-item">
          <span class="label">Distance:</span>
          <span id="distance-display">-</span>
        </div>
      </div>
      
      <div class="control-group">
        <button id="export-config" class="btn-secondary">Export Config</button>
        <button id="save-to-r2" class="btn-secondary">Save to R2</button>
      </div>
      
      <div class="control-group">
        <h3>Instructions</h3>
        <p style="font-size: 12px; color: #999; line-height: 1.6;">
          <strong>Edit Mode:</strong><br>
          • Add audio sources with the form above<br>
          • Click map to place new sources<br>
          • Drag existing sources to reposition<br>
          • Right-click sources to delete<br>
          <br>
          <strong>Preview Mode:</strong><br>
          • Move mouse to hear spatial audio<br>
          • Audio adjusts by distance & direction
        </p>
      </div>
    </div>
    
    <div id="map"></div>
  </div>
  
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="js/soundmap-builder.js"></script>
  
  <script>
    let soundmapBuilder;
    
    // Start with empty project or load existing
    const defaultConfig = {
      title: "New Soundmap",
      mapCenter: [51.5074, -0.1278],
      audioSources: []
    };
    
    soundmapBuilder = new SoundmapBuilder('map', defaultConfig);
    soundmapBuilder.init();
  </script>
</body>
</html>
